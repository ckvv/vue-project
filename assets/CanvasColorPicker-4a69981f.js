import{d as y,I as g,c as _,J as I,e as C,A as u,H as D,g as v,K as x,o as R}from"./index-28510f0c.js";const E=y({__name:"CanvasColorPicker",setup(k){const o=g(),i=g(""),s=_(()=>(o==null?void 0:o.value)&&o.value.getContext("2d")),d=()=>{let r,e;return[new Promise((n,a)=>{r=n,e=a}),r,e]},f=r=>{const[e,t,n]=d(),a=new FileReader;return a.addEventListener("loadend",l=>{var c;(c=l.target)!=null&&c.result?t(l.target.result):n(new Error("Read file fail"))}),a.addEventListener("error",l=>{n(l)}),a.readAsDataURL(r),e},m=r=>{const[e,t,n]=d(),a=new Image;return a.src=r,a.onload=()=>{t(a)},a.onerror=l=>{n(l)},e},h=(r,e)=>{const t=new ImageData(r,e),n=t.data.length;for(let a=0;a<n;a+=4){const l=a%(r*4)/(r*4)*255,c=Math.ceil(a/(e*4))/e*255;t.data[a+0]=l,t.data[a+1]=c,t.data[a+2]=255-l,t.data[a+3]=255}return o.value&&(o.value.width=r,o.value.height=e),t};I(()=>{s.value&&s.value.putImageData(h(200,200),0,0)});const p=async r=>{var n;const e=r.target.files;if(!(e!=null&&e.length))return;const t=await m(await f(e[0]));o.value&&(o.value.width=t.width,o.value.height=t.height),(n=s.value)==null||n.drawImage(t,0,0,t.width,t.height)},w=r=>{if(s.value&&o.value){const{top:e,left:t}=o.value.getBoundingClientRect(),n=s.value.getImageData(r.x-t,r.y-e,1,1).data;i.value=`rgba(${n[0]} ${n[1]} ${n[2]} /${n[3]})`}};return(r,e)=>(R(),C("div",null,[u("div",{style:x({color:v(i)})}," 选择一张图片获取当前颜色: "+D(v(i)),5),u("input",{id:"file",type:"file",accept:"image/*",onChange:p},null,32),u("canvas",{id:"offscreen",ref_key:"canvasRef",ref:o,onMousemove:w},null,544)]))}});export{E as default};
