import{d as w,M as g,c as y,N as _,o as C,a as x,b as i,g as D,t as I,n as R}from"./index-58eb18b6.js";const E=w({__name:"CanvasColorPicker",setup(k){const n=g(),s=g(new Uint8ClampedArray([0,0,0,0])),c=y(()=>(n==null?void 0:n.value)&&n.value.getContext("2d",{willReadFrequently:!0})),d=()=>{let t,r;return[new Promise((o,a)=>{t=o,r=a}),t,r]},v=t=>{const[r,e,o]=d(),a=new FileReader;return a.addEventListener("loadend",l=>{var u;(u=l.target)!=null&&u.result?e(l.target.result):o(new Error("Read file fail"))}),a.addEventListener("error",l=>{o(l)}),a.readAsDataURL(t),r},m=t=>{const[r,e,o]=d(),a=new Image;return a.src=t,a.onload=()=>{e(a)},a.onerror=l=>{o(l)},r},f=(t,r)=>{const e=new ImageData(t,r),o=e.data.length;for(let a=0;a<o;a+=4){const l=a%(t*4)/(t*4)*255,u=a/(t*4)/r*255;e.data[a+0]=l,e.data[a+1]=u,e.data[a+2]=255-l,e.data[a+3]=255}return n.value&&(n.value.width=t,n.value.height=r),e};_(()=>{c.value&&c.value.putImageData(f(200,200),0,0)});const h=async t=>{var o;const r=t.target.files;if(!(r!=null&&r.length))return;const e=await m(await v(r[0]));n.value&&(n.value.width=e.width,n.value.height=e.height),(o=c.value)==null||o.drawImage(e,0,0,e.width,e.height)},p=t=>{if(c.value&&n.value){const{top:r,left:e}=n.value.getBoundingClientRect();s.value=c.value.getImageData(t.x-e,t.y-r,1,1).data}};return(t,r)=>(C(),x("div",null,[i("div",{style:R({color:`rgba(${s.value[0]} ${s.value[1]} ${s.value[2]} /${s.value[3]})`})},[D(" 获取图片中的颜色: "+I(s.value)+", ",1),i("input",{id:"file",type:"file",accept:"image/*",onChange:h},null,32)],4),i("canvas",{id:"offscreen",ref_key:"canvasRef",ref:n,onMousemove:p},null,544)]))}});export{E as default};
