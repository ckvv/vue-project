import{d as w,P as g,c as y,Q as _,o as C,a as x,b as i,h as D,l as I,n as R}from"./index-CgNhXl7l.js";const E=w({__name:"CanvasColorPicker",setup(k){const r=g(),s=g(new Uint8ClampedArray([0,0,0,0])),c=y(()=>(r==null?void 0:r.value)&&r.value.getContext("2d",{willReadFrequently:!0}));function d(){let t,n;return[new Promise((o,a)=>{t=o,n=a}),t,n]}function v(t){const[n,e,o]=d(),a=new FileReader;return a.addEventListener("loadend",l=>{var u;(u=l.target)!=null&&u.result?e(l.target.result):o(new Error("Read file fail"))}),a.addEventListener("error",l=>{o(l)}),a.readAsDataURL(t),n}function f(t){const[n,e,o]=d(),a=new Image;return a.src=t,a.onload=()=>{e(a)},a.onerror=l=>{o(l)},n}function m(t,n){const e=new ImageData(t,n),o=e.data.length;for(let a=0;a<o;a+=4){const l=a%(t*4)/(t*4)*255,u=a/(t*4)/n*255;e.data[a+0]=l,e.data[a+1]=u,e.data[a+2]=255-l,e.data[a+3]=255}return r.value&&(r.value.width=t,r.value.height=n),e}_(()=>{c.value&&c.value.putImageData(m(200,200),0,0)});async function h(t){var o;const n=t.target.files;if(!(n!=null&&n.length))return;const e=await f(await v(n[0]));r.value&&(r.value.width=e.width,r.value.height=e.height),(o=c.value)==null||o.drawImage(e,0,0,e.width,e.height)}function p(t){if(c.value&&r.value){const{top:n,left:e}=r.value.getBoundingClientRect();s.value=c.value.getImageData(t.x-e,t.y-n,1,1).data}}return(t,n)=>(C(),x("div",null,[i("div",{style:R({color:`rgba(${s.value[0]} ${s.value[1]} ${s.value[2]} /${s.value[3]})`})},[D(" 获取图片中的颜色: "+I(s.value)+", ",1),i("input",{id:"file",type:"file",accept:"image/*",onChange:h},null,32)],4),i("canvas",{id:"offscreen",ref_key:"canvasRef",ref:r,onMousemove:p},null,544)]))}});export{E as default};
